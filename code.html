<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />
    <title>Movie List: A Coding Challenge</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous"
    />

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />

    <!-- Devicons -->

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css"
    />
    <!-- Prism CSS -->
    <link rel="stylesheet" href="/css/prism.css" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/site.css" />
  </head>
  <body>
    <header>
      <!-- START: Navbar -->
      <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="/index.html">
            <img src="/img/mainLogo1.png" height="30" alt="developer logo" />
            &nbsp;Movie List</a
          >
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link" href="/index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/app.html">The App</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/code.html"
                  >The Code</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://github.com/gelsonh"
                  >The Repo</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Blog</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- END: Navbar -->
    </header>

    <!-- START: Main -->
    <main class="container py-3">
      <div class="row">
        <h2 class="border-bottom border-2 border-dark">The Code</h2>
        <div class="col-12 col-lg-8">
          <pre class="line-numbers">
            <code class="language-js">
              const API_KEY =
              "eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJmY2U5NmYwNDIyODlhNWRjY2FiYmFjZDIzNTFiNzBhOCIsInN1YiI6IjY0YzE2ODMxZGY4NmE4MDBlNzgwMjQyNCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.O2XFMmGJG8hkQnUFu7BbenNOkwlPw98z5SqCe4cJWJM";
            
            async function getMovies() {
              try {
                const response = await fetch("https://api.themoviedb.org/3/movie/popular", {
                  headers: {
                    Authorization: `Bearer ${API_KEY}`,
                  },
                });
            
                const data = await response.json();
                return data;
              } catch (error) {
                console.error(error);
              }
            }
            
            async function displayMovies() {
              const movieListDiv = document.getElementById("movie-list");
              const moviePosterTemplate = document.getElementById("movie-card-template");
            
              const data = await getMovies();
            
              const movies = data.results; // Movies is an array of objects
            
              movies.forEach((movie) => {
                const movieCard = moviePosterTemplate.content.cloneNode(true);
            
                const titleElement = movieCard.querySelector(".card-body > h5");
                titleElement.textContent = movie.title;
            
                const movieParagraphElement = movieCard.querySelector(".card-text");
                movieParagraphElement.textContent = movie.overview;
            
                const movieImgElement = movieCard.querySelector(".card img");
                movieImgElement.setAttribute(
                  "src",
                  `https://image.tmdb.org/t/p/w500${movie.poster_path}`
                );
            
                const infoButton = movieCard.querySelector("button.btn");
                infoButton.setAttribute("data-movieId", movie.id);
            
                movieListDiv.appendChild(movieCard);
              });
            }
            
            async function showMovieDetails(btn) {
              const movieId = btn.getAttribute("data-movieId");
              const response = await fetch(
                `https://api.themoviedb.org/3/movie/${movieId}`,
                {
                  headers: {Authorization: `Bearer ${API_KEY}`},
                }
              );
              const data = await response.json();
            
              const modalBody = document.querySelector("#movie-modal .modal-body");
              modalBody.innerHTML = "";
            
              // Create row
              const row = document.createElement("div");
              row.classList.add("row");
            
              // Create left column
              const leftCol = document.createElement("div");
              leftCol.classList.add("col-sm-6", "col-md-4");
            
              // Add movie poster to left column
              const poster = document.createElement("img");
              poster.src = `https://image.tmdb.org/t/p/w500${data.poster_path}`;
              poster.classList.add("movie-poster", "img-fluid");
              leftCol.appendChild(poster);
            
              // Create right column
              const rightCol = document.createElement("div");
              rightCol.classList.add("col-sm-6", "col-md-8");
            
              // Add movie details to right column
              const title = document.createElement("h2");
              title.textContent = data.original_title;
              rightCol.appendChild(title);
            
              const details = [
                {label: "Rating", value: data.vote_average},
                {label: "Runtime", value: `${data.runtime} minutes`},
                {label: "Genres", value: data.genres.map((genre) => genre.name).join(", ")},
                {label: "Plot", value: data.overview, class: "plot-summary"},
                {label: "Cast", value: ""},
              ];
            
              details.forEach((detail) => {
                const detailElement = document.createElement("div");
                detailElement.textContent = `${detail.label}: ${detail.value}`;
                if (detail.class) detailElement.classList.add(detail.class);
                rightCol.appendChild(detailElement);
              });
            
              // Append columns to row
              row.appendChild(leftCol);
              row.appendChild(rightCol);
            
              // Append row to modal body
              modalBody.appendChild(row);
            }
            
            
            </code>
          </pre>
        </div>
        <div class="col-12 col-lg-4">
          <h5>Code Explanation</h5>
          <p>
            This code is designed to display a list of popular movies and their
            details using data from The Movie Database API. The API key is
            stored as a constant and is used to authenticate requests to the
            API. The <code>getMovies</code>
            <code>function fetches data </code>about popular movies from the API
            and returns it as a parsed JSON object. If an error occurs, it logs
            the error to the console. The <code>displayMovies</code> function
            displays a list of popular movies using a template, fetching data
            about the movies using the <code>getMovies</code> function and
            iterating over the array of movies using the
            <code>forEach</code> method. The
            <code>showMovieDetails</code> function displays detailed information
            about a specific movie when its "More Info" button is clicked, using
            the movie's ID to fetch detailed information from the API and
            populating a modal with the information.T
          </p>
        </div>
      </div>
    </main>
    <!-- END: Main -->

    <!-- START: Footer -->
    <footer class="footer container-fluid py-3 text-light text-center">
      <div class="container">
        <div class="row row-cols-1 row-cols-lg-3 align-items-center gy-2">
          <div class="col text-lg-start">&copy; 2023 Gelson Hernandez</div>
          <div class="col">
            <!-- changed for logo name -->
            <img src="/img/mainLogo1.png" height="30" />
          </div>
          <div class="col text-lg-end">
            <a href="#"><i class="socialicons bi bi-linkedin"></i></a>
            <a href="#"><i class="socialicons bi bi-github"></i></a>
            <a href="#"><i class="socialicons bi bi-twitter"></i></a>
            <a href="mailto:gelsonhz@outlook.com"
              ><i class="socialicons bi bi-envelope-at-fill"></i
            ></a>
          </div>
        </div>
      </div>
    </footer>
    <!-- END: Footer -->

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
      crossorigin="anonymous"
    ></script>

    <!-- Prism JS -->
    <script src="/js/prism.js"></script>
    <script>
      Prism.plugins.NormalizeWhitespace.setDefaults({
        "remove-trailing": true,
        "remove-indent": true,
        "left-trim": true,
        "right-trim": true,
      });
    </script>

    <!-- Site JS -->
    <script src="/js/site.js"></script>
  </body>
</html>
